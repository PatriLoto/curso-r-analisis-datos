<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ml-fundamentals.utf8</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge.css" rel="stylesheet" />
    <link rel="stylesheet" href="animate.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: inverse, center


# &lt;svg style="height:0.8em;top:.04em;position:relative;fill:steelblue;" viewBox="0 0 581 512"&gt;&lt;path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/&gt;&lt;/svg&gt;  para an√°lisis de datos üöÄ&lt;br&gt; &lt;br&gt; 

## üéâModelizaci√≥n con tidymodels üíª 
### `Clasificaci√≥n`

.large[Roxana N. Villafa√±e | LEMyP | &lt;a href='http://twitter.com/data_datum'&gt;&lt;svg style="height:0.8em;top:.04em;position:relative;fill:steelblue;" viewBox="0 0 512 512"&gt;&lt;path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/&gt;&lt;/svg&gt; @data_datum&lt;/a&gt;] &lt;br&gt; 
.large[Florencia D'Andrea | INTA-CONICET | &lt;a href="http://twitter.com/cantoflor_87"&gt; &lt;svg style="height:0.8em;top:.04em;position:relative;fill:steelblue;" viewBox="0 0 512 512"&gt;&lt;path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/&gt;&lt;/svg&gt; @cantoflor_87&lt;/a&gt;&lt;br&gt;] 


&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; Slides disponibles en &lt;https://bit.ly/curso-r-fca&gt; ‚ú®
&lt;br&gt; P√°gina web del curso en &lt;https://curso-r-fca.netlify.com&gt; üåü

---



&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Flujo de Ciencia de Datos üìå

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/flujo-ciencia-datos-ml.png" width="100%" align="center" /&gt;



---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/fondo-madera.png)
background-size: cover
class: center, middle


# Es el proceso de desarrollo de una herramienta matem√°tica o modelo que genera una predicci√≥n precisa. 
# Entrenamos un modelo para encontrar esa predicci√≥n precisa. 

.footnote[http://appliedpredictivemodeling.com/]
---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;



# Ejemplos de modelos predictivos

&lt;br&gt;

*Modelos simples 

#### Determinar si un tumor es maligno o benigno en una imagen m√©dica (clasificaci√≥n en benigno/maligno).
#### Predicci√≥n de los precios de inmuebles (regresi√≥n)
#### Identificar el c√≥digo zip de letras manuscritas en un sobre. (clasificaci√≥n en letras)

--

*Modelos m√°s complejos

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/ml-ejemplos.png" width="100%" align="right" /&gt;



---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Partes del modelo predictivo


&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/partes-modelo.png" width="100%" align="center" /&gt;


.footnote[http://appliedpredictivemodeling.com/]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Terminolog√≠a

* __Muestra, punto, observaci√≥n, instancia__ se refiere a una unidad de an√°lisis.
* __Set de entrenamiento__ son los datos utilizados para el modelado. 
* __Set de prueba__ son los datos utilizados para medir el desempe√±o del modelo, entre un conjunto de candidatos. 
* __Atributos, predictores, variables independientes o descriptores__ son los datos de entrada para la ecuaci√≥n de predicci√≥n.
* __Salida, variable dependiente, variable respuesta, clase, o "target"__ es la cantidad a ser predicha. 
* __Datos categ√≥ricos, tambi√©n conocidos como nominales o atributos__ toman valores espec√≠ficos que no tienen escala. Ejemplo: bueno/malo, rojo/azul, etc. 
* __Datos continuos__ son a base de escalas num√©ricas. El costo de un producto, la presi√≥n sangu√≠nea, etc.

.footnote[http://appliedpredictivemodeling.com/]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Modelizaci√≥n supervisada

### Clasificaci√≥n: la variable respuesta es una clase, es decir, una variable cualitativa 
En el dataset iris, el tipo de flor, iris setosa, versicolor, virginica.
### Regresi√≥n: la variable respuesta es un valor cuantitativo (un valor num√©rico a predecir). 
Predicci√≥n de precios de casas, seg√∫n variables como el barrio en el que pertenecen, n√∫mero de cuartos, si es de m√°s de un piso, etc. 


---
class:center, inverse

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="50%" align="middle" /&gt;


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# De caret a tidymodels



.pull-left[
El objetivo de caret era **unificar la sintaxis** para modelizar datos usando como base distintas librer√≠as de R. 
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/caret.png" width="100%" align="right" /&gt;
]

--

.pull-right[
El objetivo de Tidymodels es adem√°s hacerlo **en un formato ordenado**. 
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="80%" align="right" /&gt;

]


---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/fondo-madera.png)
background-size: cover
class: center, middle

# Tidymodels es un grupo de paquetes centrado en las tareas de modelizaci√≥n de datos. 
# La modelizaci√≥n consta de varios pasos, la idea es que cada paso lo realice una librer√≠a diferente. 


---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

&lt;br&gt;&lt;br&gt;
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidym2.png" width="100%" align="center" /&gt;

--

### Documentaci√≥n
- Tidymodels https://github.com/tidymodels/tidymodels
- Rsample https://tidymodels.github.io/rsample/
- Recipes https://tidymodels.github.io/recipes/reference/index.html
- Parsnip https://tidymodels.github.io/parsnip/
- Yardstick https://tidymodels.github.io/yardstick/ 

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;


# En primer lugar instalamos tidymodels

```r
install.packages(tidymodels)
```


---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;


# Librer√≠as de Tidymodels

```r
library(tidymodels)
```

```
## -- Attaching packages --------------------------- tidymodels 0.0.3 --
```

```
## v broom     0.5.4     v purrr     0.3.3
## v dials     0.0.4     v recipes   0.1.9
## v dplyr     0.8.3     v rsample   0.0.5
## v ggplot2   3.2.1     v tibble    2.1.3
## v infer     0.5.1     v yardstick 0.0.5
## v parsnip   0.0.5
```

```
## -- Conflicts ------------------------------ tidymodels_conflicts() --
## x purrr::discard()    masks scales::discard()
## x dplyr::filter()     masks stats::filter()
## x dplyr::lag()        masks stats::lag()
## x ggplot2::margin()   masks dials::margin()
## x recipes::step()     masks stats::step()
## x recipes::yj_trans() masks scales::yj_trans()
```


---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/text-msg.png)
background-size: cover
class: center, middle

# ‚ú® Data Balanceada
Los clases tienen los mismos n√∫meros de casos


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Datos: Iris

* Conjunto de datos muy popular en an√°lisis multivariado

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/iris-species.png" width="100%" align="center" /&gt;


.footnote[[*]
Mas informaci√≥n en https://es.wikipedia.org/wiki/Conjunto_de_datos_flor_iris 
https://archive.ics.uci.edu/ml/datasets/Iris]

---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Vemos los primeros 5 casos del set de datos 

```r
head(iris)
```

```
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
```

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Estad√≠stica descriptiva del set de datos

```r
summary(iris)
```

```
##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## 
```

---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

## Tenemos 150 casos o individuos (filas), 4 columnas o caracter√≠sticas (features) y 1 variable predictora (species)

```r
str(iris)
```

```
## 'data.frame':	150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
```

--

### Importante: Este set de datos no tiene valores perdidos

---
# Visualizaci√≥n

* Visualizar las variables nos permite ver gr√°ficamente las distribuciones de las variables y ver si se presentan eventuales correlaciones


```r
library(GGally) #librer√≠a GGally
iris %&gt;% #datos de entrada
  ggpairs(aes(color = Species))+ theme_bw() #funci√≥n ggpairs
```

---

![](ml-fundamentals_files/figure-html/unnamed-chunk-8-1.png)&lt;!-- --&gt;


---

# Correlaci√≥n 


```r
library(dplyr)
library(corrplot) #librer√≠a corrrplot para graficar
irisv&lt;-iris %&gt;% #ingreso de datos
  select(-Species) #elimino variable Species
M &lt;- cor(irisv) #calculo matriz de correlaci√≥n 
corrplot(M, method="number") #grafico
```

.footnote[https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/cor
y https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html]
---

![](ml-fundamentals_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;



---
class: inverse, center

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/rsample.png" width="50%" align="center" /&gt;

# `Divisi√≥n de datos`

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/rsample.png" width="10%" align="right" /&gt;

# Entrenamiento / Prueba


&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/training-testing.png" width="75%" align="center" /&gt;


---

# ¬øPor qu√© dividimos los datos?


&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/leo.png" width="100%" align="right" /&gt;


.footnote[https://projecteuclid.org/download/pdf_1/euclid.ss/1009213726 y 
https://arxiv.org/pdf/1206.5538.pdf]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/rsample.png" width="10%" align="right" /&gt;

# 1¬∞ Paso: Dividir los datos

### Crear un set de datos training / testing con la librer√≠a *rsamples*



```r
iris_split &lt;- iris %&gt;% #creo un objeto a partir de iris
  `initial_split`(prop = 0.75) #75% de los datos
iris_split 
```

```
## &lt;113/37/150&gt;
```


Estos son los datos de entrenamiento/prueba/total 

* __Vamos a _entrenar_ con 113 muestras__
* __Vamos a _validar_ con 37 muestras__


---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `initial_split()`: nos permite dividir el set de datos en entrenamiento y prueba


---

class: inverse, center

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="60%" align="center" /&gt;

# `Preprocesamiento`

---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/fondo-madera.png)
background-size: cover
class: center, middle

# El preprocesamiento se refiere a la adici√≥n, eliminaci√≥n o transformaci√≥n de los datos de entrenamiento. 

# La necesidad de preprocesar los datos de entrada est√° determinada por el tipo de modelo que se utiliza. 



---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes_allison.png" width="100%" align="center" /&gt;


.footnote[https://github.com/allisonhorst/stats-illustrations]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;

# Preprocesamiento

**_Este orden se aconseja en la documentaci√≥n_**

1. Imputaci√≥n de valores perdidos.
1. Transformaciones para variables individuales
1. Discretizar las variables (si no hubiera otra opci√≥n)
1. Creaci√≥n de variables latentes
1. Creaci√≥n de interacciones
1. Normalizaci√≥n (centrado, escalado, etc)
1. Transformaciones multivariadas (PCA, etc)


.footnote[Mas informaci√≥n en https://tidymodels.github.io/recipes/articles/Ordering.html]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;

# Centrado y Escalado

1. Datos originales
1. Centrar (media 0)
1. Escalado (desv√≠o estandar igual a 1)
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/prepro1.png" width="100%" align="right" /&gt;

.footnote[Imagen tomada de http://aikorea.org/cs231n/neural-networks-2/]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;

# 2¬∞ Paso: Preprocesamiento

- **recipe()**: empieza una lista de transformaciones a ser aplicadas
&lt;br&gt;
- **step_corr()**: remueve todas las variables con alta correlaci√≥n
- **step_center()**: centrar los datos con media igual a 0. 
- **step_scale()**: Normaliza con desv√≠o est√°ndar igual a 1. 
&lt;br&gt;
- **all_predictors()** y **all_outcomes()** son todas las variables predictivas y predictoras
- **prep()**: Indica que hay que ejecutar todos los pasos anteriores. 


```r
iris_recipe &lt;- `training`(iris_split) %&gt;%
  `recipe`(Species~.) %&gt;%
  `step_corr`(all_predictors()) %&gt;%
  `step_center`(all_predictors(), -all_outcomes()) %&gt;%
  `step_scale`(all_predictors(), -all_outcomes()) %&gt;%
  `prep`()
```


---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;


```r
iris_recipe &lt;- training(iris_split) %&gt;%
  recipe(Species~.) %&gt;%
  step_corr(all_predictors()) %&gt;%
  step_center(all_predictors(), -all_outcomes()) %&gt;%
  step_scale(all_predictors(), -all_outcomes()) %&gt;%
  prep()
```


```r
iris_recipe
```

```
## Data Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          4
## 
## Training data contained 113 data points and no missing data.
## 
## Operations:
## 
## Correlation filter removed Petal.Length [trained]
## Centering for Sepal.Length, Sepal.Width, Petal.Width [trained]
## Scaling for Sepal.Length, Sepal.Width, Petal.Width [trained]
```

---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `recipe()`: especifico f√≥rmula
# `step_corr()`: remuevo las variables correlacionadas
# `step_center()`: centrar 
# `step_scale()`: escalar
# `prep()`: ejecutar


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;

## juice()
- **juice()** se utiliza para darle formato final al dataset antes del procesamiento de los datos

#### juice() aplicamos a los datos de entrenamiento

```r
iris_training &lt;- `juice`(iris_recipe)
```


```r
head(iris_training)
```

```
## # A tibble: 6 x 4
##   Sepal.Length Sepal.Width Petal.Width Species
##          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
## 1       -0.985       1.06        -1.44 setosa 
## 2       -1.23       -0.108       -1.44 setosa 
## 3       -1.60        0.126       -1.44 setosa 
## 4       -1.11        1.29        -1.44 setosa 
## 5       -0.615       2.00        -1.16 setosa 
## 6       -1.60        0.827       -1.30 setosa
```

.footnote[https://tidymodels.github.io/recipes/reference/juice.html
]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/recipes.png" width="10%" align="right" /&gt;

## bake()
- **bake()** toma un recipiente entreanado y aplica las operaciones a un set de datos para crear la matriz de dise√±o. 

#### bake() aplicamos a los datos de prueba

```r
iris_testing &lt;- iris_recipe %&gt;%
  `bake`(testing(iris_split))
head(iris_testing)
```

```
## # A tibble: 6 x 4
##   Sepal.Length Sepal.Width Petal.Width Species
##          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
## 1       -1.48        0.360       -1.44 setosa 
## 2       -1.23        0.126       -1.57 setosa 
## 3       -1.36       -0.108       -1.57 setosa 
## 4       -0.122       2.23        -1.44 setosa 
## 5       -0.985       1.06        -1.30 setosa 
## 6       -0.246       1.76        -1.30 setosa
```



.footnote[https://tidymodels.github.io/recipes/reference/bake.html
]
---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle


# `juice()`: formato final a datos de entrenamiento
# `bake()`: aplicar transformaciones a datos de prueba


---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# recipe --&gt; prep() --&gt; bake/juice
# (definir) --&gt; (estimar) --&gt; (aplicar)



---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/textura-fondo.png)
background-size: cover
class: center, middle, inverse


# üîß DEMO üíª


---
class: inverse, center

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip_h.png" width="70%" align="center" /&gt;

# `Modelizaci√≥n`


---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/fondo-madera.png)
background-size: cover
class: center, middle

# En esta etapa se realiza el ajuste de varios modelos
# Cada modelo tiene variables internas propias que surgen de su expresi√≥n matem√°tica
# No existe el mejor modelo, siempre depende del conjunto de datos utilizado

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip_allison.png" width="100%" align="center" /&gt;


.footnote[https://github.com/allisonhorst/stats-illustrations]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# √Årboles de decisi√≥n (Decision Trees)

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/bret-tree.png" width="100%" align="center" /&gt;

.footnote[Imagen tomada de https://www.packtpub.com/big-data-and-business-intelligence/machine-learning-r-second-edition]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# √Årboles de decisi√≥n (Decision Trees)

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/decision1.png" width="100%" align="center" /&gt;

.footnote[https://bookdown.org/content/2031/arboles-de-decision-parte-i.html#que-son-los-arboles-de-decision]
---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# Bosques aleatorios (Random Forest)


&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/netflix-rf.png" width="100%" align="center" /&gt;



.footnote[https://en.wikipedia.org/wiki/Netflix_Prize y https://static.aminer.org/pdf/PDF/000/294/514/random_decision_forests.pdf]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# Bosques aleatorios (Random Forest)

* Random Forest usa como algoritmo base los √°rboles de decisi√≥n
* Bootstrap (muestreo con reemplazo) + Bagging 

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/random-forest.png" width="100%" align="center" /&gt;

.footnote[https://bookdown.org/content/2031/ensambladores-random-forest-parte-i.html]

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

### Out-of-bag error

Error de validaci√≥n interna del modelo

### mtry

N√∫mero de variables elegidas de manera aleatoria como candidatas para cada split.

### Gini index (√çndice Gini)

Medida de varianza entre las clases. Nos permite medir la pureza del nodo. Un nodo m√°s puro es cuando mas similares son entre s√≠, los elementos clasificados. 


.footnote[http://faculty.marshall.usc.edu/gareth-james/ISL/]
---



&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

## 3¬∞ Paso: Entrenamiento del modelo

- Para a entrenar un modelo de random forest con librer√≠a {ranger} y {randomForest} en el set de entrenamiento. 
- Se puede entrenar cualquier modelo de clasificaci√≥n o regresi√≥n
- Partes:
1. *rand_forest()*: es el nombre de tidymodels para el modelo.
1. *set_engine()*: especifico librer√≠a que contiene el modelo.
1. *fit()*: ajuste de la funci√≥n seg√∫n la f√≥rmula y los datos


```r
iris_ranger &lt;- #creo objeto de R
  `rand_forest`(trees = 500, mode = "classification") %&gt;%
  `set_engine`("ranger") %&gt;% #escifico librer√≠a
  `fit`(Species~., data = iris_training) #ajuste

iris_ranger 
```


.footnote[M√°s informaci√≥n en 
https://tidymodels.github.io/parsnip/articles/articles/Models.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;
{ranger}

```
## parsnip model object
## 
## Fit time:  51ms 
## Ranger result
## 
## Call:
##  ranger::ranger(formula = formula, data = data, num.trees = ~500,      num.threads = 1, verbose = FALSE, seed = sample.int(10^5,          1), probability = TRUE) 
## 
## Type:                             Probability estimation 
## Number of trees:                  500 
## Sample size:                      113 
## Number of independent variables:  3 
## Mtry:                             1 
## Target node size:                 10 
## Variable importance mode:         none 
## Splitrule:                        gini 
## OOB prediction error (Brier s.):  0.06147664
```


---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `rand_forest()`: declaro `trees` y el `mode` (clasificaci√≥n)
# `set_engine()`: declaro que librer√≠a voy a usar
# `fit()`:declaro la f√≥rmula y los datos de entrada


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# `predict()`

```r
predict(objeto, datos_nuevos)
```


* El objeto es un objeto de clase "model fit" (obtenido en el paso anterior)
* datos_nuevos es un tibble o data.frame


.footnote[https://tidymodels.github.io/parsnip/reference/predict.model_fit.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# `predict()`

```r
iris_ranger %&gt;%
  `predict`(iris_testing) #predicci√≥n
```

```
## # A tibble: 37 x 1
##    .pred_class
##    &lt;fct&gt;      
##  1 setosa     
##  2 setosa     
##  3 setosa     
##  4 setosa     
##  5 setosa     
##  6 setosa     
##  7 setosa     
##  8 setosa     
##  9 setosa     
## 10 setosa     
## # ... with 27 more rows
```


.footnote[https://tidymodels.github.io/parsnip/reference/predict.model_fit.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/parsnip.png" width="15%" align="right" /&gt;

# `bind_cols()`


```r
iris_ranger %&gt;%
  `predict`(iris_testing) %&gt;%
  `bind_cols`(iris_testing) # me permite comparar
```

```
## # A tibble: 37 x 5
##    .pred_class Sepal.Length Sepal.Width Petal.Width Species
##    &lt;fct&gt;              &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1 setosa            -1.48        0.360       -1.44 setosa 
##  2 setosa            -1.23        0.126       -1.57 setosa 
##  3 setosa            -1.36       -0.108       -1.57 setosa 
##  4 setosa            -0.122       2.23        -1.44 setosa 
##  5 setosa            -0.985       1.06        -1.30 setosa 
##  6 setosa            -0.246       1.76        -1.30 setosa 
##  7 setosa            -0.985       1.53        -1.16 setosa 
##  8 setosa            -1.60        1.29        -1.44 setosa 
##  9 setosa            -1.11       -0.108       -1.44 setosa 
## 10 setosa            -0.862       1.06        -1.44 setosa 
## # ... with 27 more rows
```


.footnote[https://dplyr.tidyverse.org/reference/bind.html]


---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `predict()`: me permite hacer la predicci√≥n del modelo con datos nuevos
# `bind_cols()`: me permite comparar los resultados con los valores verdaderos





---
class: inverse, center

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.png" width="60%" align="center" /&gt;

# `Validaci√≥n`

---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/fondo-madera.png)
background-size: cover
class: center, middle

# Durante la validaci√≥n, evaluamos el modelo predictivo
# Esa evaluaci√≥n puede ser mediante una m√©trica o un gr√°fico

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# Evaluaci√≥n de un clasificador 

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/eval-clasificador.png" width="100%" align="right" /&gt;



---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# Matriz de Confusi√≥n

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/matriz-confusion.png" width="100%" align="right" /&gt;


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# Curvas ROC

* Las curvas ROC son una poderosa herramienta gr√°fica para visualizar el desempe√±o de un algoritmo de aprendizaje a trav√©s de una variaci√≥n en el criterio de decisi√≥n. 
&lt;br&gt;&lt;br&gt;
* Las curvas ROC se han utilizado no s√≥lo para __estudiar el comportamiento de un algoritmo__ sino tambi√©n __identificar regiones √≥ptimas de desempe√±o__, __realizar la selecci√≥n de modelos__, y lo m√°s importante para __comparar y evaluar algoritmos de aprendizaje autom√°tico__. 
&lt;br&gt;&lt;br&gt;
* En el _eje X_ de una curva ROC tenemos el eje horizontal, que muestra la _tasa de falsos positivos (TFP)_ y el eje vertical (_eje y_) muestra la _tasa de verdaderos positivos_ de un clasificador. 



---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

## 4¬∞ Paso: Validaci√≥n del modelo predictivo

### Random Forest con librer√≠a `ranger`

```r
iris_ranger %&gt;%
  predict(iris_testing) %&gt;% #predicci√≥n
  bind_cols(iris_testing) %&gt;% #comparar 
  `metrics`(truth=Species, estimate=.pred_class) #m√©tricas
```

```
## # A tibble: 2 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy multiclass     0.973
## 2 kap      multiclass     0.958
```

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt; 

# `metrics()`

```r
iris_ranger %&gt;%
  `predict`(iris_testing) %&gt;%
  `bind_cols`(iris_testing) %&gt;%
  `metrics`(truth=Species, estimate=.pred_class)
```

```
## # A tibble: 2 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy multiclass     0.973
## 2 kap      multiclass     0.958
```


---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# `sens()`

```r
iris_ranger %&gt;%
  predict(iris_testing) %&gt;%
  bind_cols(iris_testing) %&gt;%
  `sens`(truth=Species, estimate=.pred_class) #sensibilidad
```

```
## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 sens    macro          0.967
```

.footnote[https://tidymodels.github.io/yardstick/reference/sens.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt; 

# `spec()`


```r
iris_ranger %&gt;%
  predict(iris_testing) %&gt;%
  bind_cols(iris_testing) %&gt;%
  `spec`(truth=Species, estimate=.pred_class) #especificidad
```

```
## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 spec    macro          0.988
```


.footnote[https://tidymodels.github.io/yardstick/reference/spec.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt; 

# `precision()`

```r
iris_ranger %&gt;%
  predict(iris_testing) %&gt;%
  bind_cols(iris_testing) %&gt;%
  `precision`(truth=Species, estimate=.pred_class) #precisi√≥n
```

```
## # A tibble: 1 x 3
##   .metric   .estimator .estimate
##   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1 precision macro          0.970
```

.footnote[https://tidymodels.github.io/yardstick/reference/precision.html]
---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# `conf_mat()`


```r
iris_ranger %&gt;%
  predict(iris_testing) %&gt;%
  bind_cols(iris_testing) %&gt;%
  `conf_mat`(truth=Species, estimate=.pred_class) #matriz de confusi√≥n
```

```
##             Truth
## Prediction   setosa versicolor virginica
##   setosa         17          0         0
##   versicolor      0         10         1
##   virginica       0          0         9
```

.footnote[https://tidymodels.github.io/yardstick/reference/conf_mat.html]

---
background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `metrics()`: exactitud y kappa
# `sens()`: sensibilidad
# `spec()`: especificidad
# `precision()`: precisi√≥n
# `conf_mat()`: matriz de confusi√≥n



---

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;

# Obtengo las probabilidades



```r
iris_probs &lt;- iris_ranger %&gt;%
  `predict`(iris_testing, type = "prob") %&gt;%
  bind_cols(iris_testing)%&gt;%
  select(.pred_setosa:.pred_virginica, Species)
iris_probs
```

```
## # A tibble: 37 x 4
##    .pred_setosa .pred_versicolor .pred_virginica Species
##           &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt; &lt;fct&gt;  
##  1        0.978          0.0125         0.00914  setosa 
##  2        0.935          0.0402         0.0250   setosa 
##  3        0.978          0.0169         0.00495  setosa 
##  4        0.791          0.168          0.0408   setosa 
##  5        0.995          0.00483        0.000133 setosa 
##  6        0.794          0.179          0.0276   setosa 
##  7        0.990          0.0045         0.00599  setosa 
##  8        0.987          0.00025        0.0127   setosa 
##  9        0.888          0.0960         0.0163   setosa 
## 10        0.997          0.00252        0.000133 setosa 
## # ... with 27 more rows
```




---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/yardstick.jpg" width="10%" align="right" /&gt;


```r
iris_probs%&gt;%
  roc_curve(Species, .pred_setosa:.pred_virginica) %&gt;%
  autoplot()
```

![](ml-fundamentals_files/figure-html/unnamed-chunk-31-1.png)&lt;!-- --&gt;

.footnote[https://tidymodels.github.io/yardstick/reference/roc_curve.html]
---

background-image: url(C:/Users/Roxana/curso-r-analisis-datos/img/engine3.png)
background-size: cover
class: center, middle

# `roc_curve()`: curva ROC
# `autoplot()`: me permite graficar




---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# Resumiendo

&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/resumen-tidymodels.png" width="100%" align="right" /&gt;

---
&lt;img src="C://Users/Roxana/curso-r-analisis-datos/img/tidymodels.png" width="10%" align="right" /&gt;

# NO OLVIDAR 

## Para buscar informaci√≥n sobre alguna funci√≥n en particular


```r
library(tidymodels)
?initial_split
?recipe
?bake
?rand_forest
?metrics
```

---
# Bibliograf√≠a

- Tutorial de Tidymodels
https://rviews.rstudio.com/2019/06/19/a-gentle-intro-to-tidymodels/
- Tutorial de Tidymodels (espa√±ol)
https://diegokoz.github.io/EEA2019/clase%208/tidymodels.nb.html
- Tutorial "Modeling with parsnip and tidymodels"
https://www.benjaminsorensen.me/post/modeling-with-parsnip-and-tidymodels/
- parsnip: A tidy model interface - Max Kuhn (video)
bit.ly/parsnip-rstudioconf2019 
- Recipes for data Preprocessing - Max Kuhn (video)
bit.ly/recipes-useR2018
- √Årboles de decisi√≥n y Random Forest
https://bookdown.org/content/2031/ 
- Applied Predictive Modeling 
http://appliedpredictivemodeling.com/ 



---


```r
sessionInfo() 
```

```
## R version 3.6.2 (2019-12-12)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 18362)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Spanish_Argentina.1252  LC_CTYPE=Spanish_Argentina.1252   
## [3] LC_MONETARY=Spanish_Argentina.1252 LC_NUMERIC=C                      
## [5] LC_TIME=Spanish_Argentina.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] corrplot_0.84     GGally_1.4.0      yardstick_0.0.5   tibble_2.1.3     
##  [5] rsample_0.0.5     tidyr_1.0.2       recipes_0.1.9     purrr_0.3.3      
##  [9] parsnip_0.0.5     infer_0.5.1       ggplot2_3.2.1     dplyr_0.8.3      
## [13] dials_0.0.4       scales_1.1.0      broom_0.5.4       tidymodels_0.0.3 
## [17] emo_0.0.0.9000    fontawesome_0.1.0
## 
## loaded via a namespace (and not attached):
##   [1] backports_1.1.5      xaringan_0.14        workflows_0.1.0     
##   [4] tidytext_0.2.2       plyr_1.8.4           igraph_1.2.4.2      
##   [7] lazyeval_0.2.2       splines_3.6.2        crosstalk_1.0.0     
##  [10] listenv_0.8.0        SnowballC_0.6.0      rstantools_2.0.0    
##  [13] inline_0.3.15        digest_0.6.23        foreach_1.4.8       
##  [16] htmltools_0.4.0      rsconnect_0.8.16     fansi_0.4.1         
##  [19] magrittr_1.5         globals_0.12.5       gower_0.2.1         
##  [22] matrixStats_0.55.0   xts_0.12-0           prettyunits_1.1.1   
##  [25] colorspace_1.4-1     xfun_0.12            callr_3.4.1         
##  [28] crayon_1.3.4         lme4_1.1-21          survival_3.1-8      
##  [31] zoo_1.8-7            iterators_1.0.12     glue_1.3.1          
##  [34] gtable_0.3.0         ipred_0.9-9          pkgbuild_1.0.6      
##  [37] rstan_2.19.2         miniUI_0.1.1.1       Rcpp_1.0.3          
##  [40] xtable_1.8-4         GPfit_1.0-8          stats4_3.6.2        
##  [43] lava_1.6.6           StanHeaders_2.21.0-1 prodlim_2019.11.13  
##  [46] DT_0.12              htmlwidgets_1.5.1    threejs_0.3.3       
##  [49] RColorBrewer_1.1-2   farver_2.0.3         reshape_0.8.8       
##  [52] pkgconfig_2.0.3      loo_2.2.0            nnet_7.3-12         
##  [55] utf8_1.1.4           labeling_0.3         tidyselect_0.2.5    
##  [58] rlang_0.4.2          DiceDesign_1.8-1     reshape2_1.4.3      
##  [61] later_1.0.0          munsell_0.5.0        tools_3.6.2         
##  [64] cli_2.0.1            generics_0.0.2       ranger_0.12.1       
##  [67] ggridges_0.5.2       evaluate_0.14        stringr_1.4.0       
##  [70] fastmap_1.0.1        yaml_2.2.1           processx_3.4.1      
##  [73] knitr_1.28           future_1.16.0        nlme_3.1-142        
##  [76] mime_0.9             rstanarm_2.19.2      rstudioapi_0.11     
##  [79] tokenizers_0.2.1     compiler_3.6.2       bayesplot_1.7.1     
##  [82] shinythemes_1.1.2    tidyposterior_0.0.2  lhs_1.0.1           
##  [85] stringi_1.4.5        ps_1.3.0             lattice_0.20-38     
##  [88] Matrix_1.2-18        nloptr_1.2.1         markdown_1.1        
##  [91] shinyjs_1.1          vctrs_0.2.2          pillar_1.4.3        
##  [94] lifecycle_0.1.0      furrr_0.1.0          httpuv_1.5.2        
##  [97] R6_2.4.1             promises_1.1.0       gridExtra_2.3       
## [100] janeaustenr_0.1.5    codetools_0.2-16     boot_1.3-23         
## [103] colourpicker_1.0     MASS_7.3-51.4        gtools_3.8.1        
## [106] assertthat_0.2.1     withr_2.1.2          shinystan_2.5.0     
## [109] parallel_3.6.2       grid_3.6.2           rpart_4.1-15        
## [112] timeDate_3043.102    class_7.3-15         minqa_1.2.4         
## [115] rmarkdown_2.1        pROC_1.16.1          tidypredict_0.4.3   
## [118] shiny_1.4.0          lubridate_1.7.4      base64enc_0.1-3     
## [121] dygraphs_1.1.1.6
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
